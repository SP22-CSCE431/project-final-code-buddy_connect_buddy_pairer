<head>  
<%= stylesheet_link_tag 'posts'%>
</head>
<body>

<p id="notice"><%= notice %></p>

<div class = "post-container">
  <div class = "card">
    <div class = "card-body">
      <h1 class = "card-title"> <%= @post.title %> </h1> <br></br>
      <h3 class = "card-subtitle mb-2 text-muted" style = "font-size: 70%">
        <strong>Posted by</strong> 
        <%=User.where(studentId: @post.posterId).first ? User.where(studentId: @post.posterId).first.firstName : "None" %>
        <strong>on</strong>
        <%= @post.postDate %>
      </h3>
    </div>
  </div>
</div>

<div class = "comments-container">
  <div class = "card">
    <div class = "card-body">
      <h1 class = "card-subtitle mb-2 text-muted" style = "font-size: 100%"> <strong>Comments</strong></h1>
      <%Comment.where(postId: @post.postId).each do |comment| %>
        <div class = "comment>
        <tr>
          <td><%=User.where(studentId: @post.posterId).first ? User.where(studentId: @post.posterId).first.firstName : "None"%> said: %></td>
          <td><%=comment.message%></td> </br>
          <td><%= time_ago_in_words(comment.commentDate)%> ago</td>
          <%if current_user.studentId == comment.posterId%>
            <td><%= link_to 'Edit', edit_comment_path(comment) %></td>
            <td><%= link_to 'Destroy', comment, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <%elsif current_user.isAdmin%>
            <td><%= link_to 'Edit', edit_comment_path(comment) %></td>
            <td><%= link_to 'Destroy', comment, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <%end%>
        </tr>
        </div>
      <%end%>
    </div>
  </div>
</div>

<!--
  <%Comment.where(postId: @post.postId).each do |comment| %>
    <tr>
      <td><%=User.where(studentId: @post.posterId).first ? User.where(studentId: @post.posterId).first.firstName : "None"%> said: </td>
      <td><%=comment.message%> </td>
      <br/>
      <td><%= time_ago_in_words(comment.commentDate)%> ago</td>
    </tr>
    <%if current_user.studentId == comment.posterId%>
      <%= link_to 'Edit', edit_comment_path(comment) %>
      <%= link_to 'Destroy', comment, method: :delete, data: { confirm: 'Are you sure?' } %>
    <%elsif current_user.isAdmin%>
      <%= link_to 'Edit', edit_comment_path(comment) %>
      <%= link_to 'Destroy', comment, method: :delete, data: { confirm: 'Are you sure?' } %>
    <%end%>
    <br/>
    <br/>
<% end %>
-->

<%if current_user.isOfficer%>
<p>
  <strong>Reply to thread<strong>
 <%= form_with model: @post do |form|%>
<div class = "field">
    <%= form.label :message %>
    <%= form.text_field :message %>
</div>
<div class = "actions">
   <%= form.submit %>
</div>
<%end%>
<p>
<%end%>

<%if current_user.isAdmin%>
  <%= link_to 'Edit', edit_post_path(@post) %> |
  <%= button_to 'Destroy', @post, method: :delete, data: { confirm: 'Are you sure?' } %> |
<% elsif current_user.studentId == @post.posterId%>
    <%= link_to 'Edit', edit_post_path(@post) %> |
    <%= button_to'Destroy', @post, method: :delete, data: { confirm: 'Are you sure?' } %> |
<%end%>
<%= link_to 'Back', posts_path %> |
<%= link_to 'Edit', edit_post_path(@post) %> |
<%= link_to 'All Posts', posts_path %>

</body>